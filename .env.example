# ==============================================================================
# OLake Slack Community Agent - Environment Configuration
# ==============================================================================
# Copy this file to .env and fill in your values

# ------------------------------------------------------------------------------
# LLM Provider Configuration (choose one)
# ------------------------------------------------------------------------------
# OpenAI (if using GPT models)
OPENAI_API_KEY=sk-...

# Google Gemini (if using Gemini models)
GEMINI_API_KEY=
OPENROUTER_API_KEY=
# Default LLM provider: "openai" or "gemini"
LLM_PROVIDER=gemini

# OpenRouter model selection (https://openrouter.ai/models)
OPENROUTER_MODEL=stepfun/step-3.5-flash:free
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1

# ------------------------------------------------------------------------------
# Slack API Credentials
# Get these from https://api.slack.com/apps
# ------------------------------------------------------------------------------
# Bot User OAuth Token (starts with xoxb-)
SLACK_BOT_TOKEN=xoxb-...

# Signing Secret (for verifying webhook requests)
SLACK_SIGNING_SECRET=...

# App ID (optional, for reference)
SLACK_APP_ID=...

# Client ID and Secret (for OAuth flow if needed)
SLACK_CLIENT_ID=...
SLACK_CLIENT_SECRET=...

# ------------------------------------------------------------------------------
# Agent Behavior Configuration
# ------------------------------------------------------------------------------
# Maximum reasoning iterations before responding
MAX_REASONING_ITERATIONS=5

# Confidence threshold for auto-reply (0.0 - 1.0)
# Below this, agent will escalate or ask for clarification
CONFIDENCE_THRESHOLD_FOR_AUTO_REPLY=0.75

# Enable multi-iteration deep reasoning
ENABLE_DEEP_REASONING=true

# Enable user pattern learning and profiling
ENABLE_USER_LEARNING=true

# Maximum conversation context to load (number of past messages)
MAX_CONTEXT_MESSAGES=10

# ------------------------------------------------------------------------------
# Documentation Search Configuration
# ------------------------------------------------------------------------------
# Enable vector search for documentation
ENABLE_VECTOR_SEARCH=true

# Maximum number of documents to retrieve
MAX_RETRIEVED_DOCS=5

# Document relevance threshold (0.0 - 1.0)
DOC_RELEVANCE_THRESHOLD=0.6

# Path to documentation/knowledge base directory
DOCS_PATH=docs/olake_knowledge_base

# ------------------------------------------------------------------------------
# RAG Service Configuration (for semantic search)
# ------------------------------------------------------------------------------
# RAG service HTTP endpoint (default: http://localhost:7070)
RAG_SERVICE_URL=http://localhost:7070

# Timeout for RAG service requests (seconds)
RAG_TOOL_TIMEOUT=10

# Qdrant vector database URL (used by RAG service)
# Local: ./qdrant_db
# Docker: http://qdrant:6333
# Cloud: https://your-cluster.cloud.qdrant.io
QDRANT_URL=http://localhost:6333

# Qdrant API key (only for Qdrant Cloud)
QDRANT_API_KEY=

# Collection names in Qdrant
DOCS_COLLECTION=olake_docs
CODE_COLLECTION=olake_code

# Embedding model (cached locally in ~/.cache/huggingface/hub)
EMBED_MODEL=nomic-ai/nomic-embed-text-v1.5
EMBED_BATCH_SIZE=64
EMBED_DEVICE=cpu

# ------------------------------------------------------------------------------
# Database Configuration
# ------------------------------------------------------------------------------
# Path to SQLite database for persistence
DATABASE_PATH=data/slack_agent.db

# ------------------------------------------------------------------------------
# Logging Configuration
# ------------------------------------------------------------------------------
# Log level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# Log directory (will create events.jsonl, errors.jsonl, reasoning.jsonl)
LOG_DIR=logs

# ------------------------------------------------------------------------------
# Server Configuration (HTTP Webhook Mode)
# ------------------------------------------------------------------------------
# Port for webhook server
WEBHOOK_PORT=3000

# Webhook path
WEBHOOK_PATH=/slack/events

# For local development, use ngrok:
# ngrok http 3000
# Then set the Request URL in Slack: https://your-ngrok-url.ngrok.io/slack/events

# ------------------------------------------------------------------------------
# Channel-Specific Configuration (Optional)
# ------------------------------------------------------------------------------
# Channels where bot should NOT respond automatically
IGNORED_CHANNELS=

# Channels that always require human approval before responding
HIGH_PRIORITY_CHANNELS=

# Users to notify for escalations (comma-separated user IDs)
ESCALATION_USERS=

# OLake Community Agent — Docker Compose (Qdrant Only)
#
# This configuration runs only Qdrant in Docker.
# The RAG service and Agent service run locally with Python 3.11.
#
# Usage:
#   docker-compose up -d              # Start Qdrant
#   docker-compose down               # Stop Qdrant
#   docker-compose logs -f            # View Qdrant logs
#
# Local development setup:
#   1. Start Qdrant: docker-compose up -d
#   2. Activate venv: source .venv/bin/activate
#   3. Run RAG: python -m services.rag.server
#   4. Run Agent: python -m agent.main

services:
  # ── Qdrant Vector Database ─────────────────────────────────────────────
  qdrant:
    image: qdrant/qdrant:latest
    restart: unless-stopped
    ports:
      - "6333:6333"   # REST API
      - "6334:6334"   # gRPC
    volumes:
      - ./qdrant_data:/qdrant/storage  # Persist data locally
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:6333/readyz"]
      interval: 10s
      timeout: 5s
      retries: 6
      start_period: 10s

volumes:
  qdrant_data:
